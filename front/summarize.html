<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Summarize</title>
</head>
<body>
	<h1>Summarize</h1>
	<form id="apiForm">
		<label for="api-key">Api key:</label>
		<input type="text" id="api-key" name="api-key" autocomplete="on" autofocus required><br><br>

		<label for="email">*Email:</label>
		<input type="email" id="email" name="email" autocomplete="on"><br><br>

		<label for="length">Summary length (number of words):</label>
		<input type="number" id="length" name="length" value="300" min="20" max="2000" autocomplete="on" required><br><br>

		<label for="expertise">Expertise:</label>
		<textarea id="expertise" name="expertise" rows="3" cols="33" autocomplete="on" required></textarea><br><br>
		
		<label for="directive">Directive:</label>
		<textarea id="directive" name="directive" rows="3" cols="33" autocomplete="on" required></textarea><br><br>

		<label for="urls">Links (urls):</label>
		<textarea id="urls" name="urls" rows="6" cols="33" required></textarea><br><br>

		<button type="submit">Submit</button>
	</form>

	<p id="response"></p>

	<script>
		document.getElementById('apiForm').addEventListener('submit', function(event) {
			event.preventDefault();

			const apiKey = document.getElementById('api-key').value;
			const email = document.getElementById('email').value;
			const length = document.getElementById('length').value;
			const expertise = document.getElementById('expertise').value;
			const directive = document.getElementById('directive').value;
			const urls = document.getElementById('urls').value;

			const apiEndpoint = 'https://localhost:9443/summarize';
			const data = {
				apiKey: apiKey,
				email: email,
				length: length,
				expertise: expertise,
				directive: directive,
				urls: urls,
			};
			
			fetch(apiEndpoint, {
				method: 'POST',
				headers: {
						'Content-Type': 'application/json'
				},
				body: JSON.stringify(data)
			})
			.then(response => response.json())
			.then(data => {
				console.log(data);
				if (data['summary'] === undefined) {
					document.getElementById('response').innerText = 
						'Error: ' + data['message'] ?? 'something went wrong';
				} else {
					document.getElementById('response').innerText = data['summary'];
				}
			})
			.catch((error) => {
				document.getElementById('response').innerText = 'Error: ' + error;
			});
		})
	</script>
</body>
</html>
